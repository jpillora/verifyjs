/** Verify.js - v0.0.1 - 2013/04/05
 * https://github.com/jpillora/verify
 * Copyright (c) 2013 Jaime Pillora - MIT
 */
(function(e,t,i){function n(e,t){function n(){p("ajax error"),t.callback("There has been an error")}function r(){c.prompt(l,!1);for(var e=s.loading[f];e.length;)e.pop().success.apply(t,arguments);s.loaded[f]=arguments}var o={method:"GET",timeout:15e3},u=t._exec,l="GroupRuleExecution"===u.type?u.element.domElem:t.field,h=e.success,d=e.error,c=u.element.options,f=JSON?JSON.stringify(e):a(),m={success:h,error:d||n};if(s.loaded[f]){var g=s.loaded[f],v=m.success;return v.apply(t,g),i}if(s.loading[f]||(s.loading[f]=[]),s.loading[f].push(m),1===s.loading[f].length){c.prompt(l,"Checking...","load");var y={success:r,error:r};u.ajax=$.ajax($.extend(o,e,y))}}function r(e){$.extend(!0,this,e)}(function(e,t){"use strict";var n,r,s,a,o,u,l,h,d,c,p,f;c="notify",a="__"+c,r={top:"bottom",bottom:"top",left:"right",right:"left"},f={core:{html:'<div class="'+a+'Wrapper">\n  <div class="'+a+'Arrow"></div>\n  <div class="'+a+'Container"></div>\n</div>',css:"."+a+"Corner {\n  position: fixed;\n  top: 0;\n  right: 0;\n  margin: 5px;\n  z-index: 1050;\n}\n\n."+a+"Corner ."+a+"Wrapper,\n."+a+"Corner ."+a+"Container {\n  position: relative;\n  display: block;\n  height: inherit;\n  width: inherit;\n}\n\n."+a+"Wrapper {\n  z-index: 1;\n  position: absolute;\n  display: inline-block;\n  height: 0;\n  width: 0;\n  opacity: 0.85;\n}\n\n."+a+"Container {\n  display: none;\n  z-index: 1;\n  position: absolute;\n  cursor: pointer;\n}\n\n."+a+"Text {\n  position: relative;\n}\n\n."+a+"Arrow {\n  margin-top: "+(2+(5===t.documentMode?-4*size:0))+"px;\n  position: absolute;\n  z-index: 2;\n  margin-left: 10px;\n  width: 0;\n  height: 0;\n}\n"},user:{"default":{html:'<div class="'+a+'Default" \n     data-notify-style="\n      color: {{color}}; \n      border-color: {{color}};\n     ">\n   <span data-notify="text"></span>\n </div>',css:"."+a+"Default {\n  background: #fff;\n  font-size: 11px;\n  box-shadow: 0 0 6px #000;\n  -moz-box-shadow: 0 0 6px #000;\n  -webkit-box-shadow: 0 0 6px #000;\n  padding: 4px 10px 4px 8px;\n  border-radius: 6px;\n  border-style: solid;\n  border-width: 2px;\n  -moz-border-radius: 6px;\n  -webkit-border-radius: 6px;\n  white-space: nowrap;\n}"},bootstrap:{html:'<div class="alert alert-error '+a+'Bootstrap">\n  <strong data-notify="text"></strong>\n</div>',css:"."+a+"Bootstrap {\n  white-space: nowrap;\n  margin-bottom: 5px !important;\n  padding-left: 25px !important;\n  background-repeat: no-repeat;\n  background-position: 3px 7px;\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtRJREFUeNqkVc1u00AQHq+dOD+0poIQfkIjalW0SEGqRMuRnHos3DjwAH0ArlyQeANOOSMeAA5VjyBxKBQhgSpVUKKQNGloFdw4cWw2jtfMOna6JOUArDTazXi/b3dm55socPqQhFka++aHBsI8GsopRJERNFlY88FCEk9Yiwf8RhgRyaHFQpPHCDmZG5oX2ui2yilkcTT1AcDsbYC1NMAyOi7zTX2Agx7A9luAl88BauiiQ/cJaZQfIpAlngDcvZZMrl8vFPK5+XktrWlx3/ehZ5r9+t6e+WVnp1pxnNIjgBe4/6dAysQc8dsmHwPcW9C0h3fW1hans1ltwJhy0GxK7XZbUlMp5Ww2eyan6+ft/f2FAqXGK4CvQk5HueFz7D6GOZtIrK+srupdx1GRBBqNBtzc2AiMr7nPplRdKhb1q6q6zjFhrklEFOUutoQ50xcX86ZlqaZpQrfbBdu2R6/G19zX6XSgh6RX5ubyHCM8nqSID6ICrGiZjGYYxojEsiw4PDwMSL5VKsC8Yf4VRYFzMzMaxwjlJSlCyAQ9l0CW44PBADzXhe7xMdi9HtTrdYjFYkDQL0cn4Xdq2/EAE+InCnvADTf2eah4Sx9vExQjkqXT6aAERICMewd/UAp/IeYANM2joxt+q5VI+ieq2i0Wg3l6DNzHwTERPgo1ko7XBXj3vdlsT2F+UuhIhYkp7u7CarkcrFOCtR3H5JiwbAIeImjT/YQKKBtGjRFCU5IUgFRe7fF4cCNVIPMYo3VKqxwjyNAXNepuopyqnld602qVsfRpEkkz+GFL1wPj6ySXBpJtWVa5xlhpcyhBNwpZHmtX8AGgfIExo0ZpzkWVTBGiXCSEaHh62/PoR0p/vHaczxXGnj4bSo+G78lELU80h1uogBwWLf5YlsPmgDEd4M236xjm+8nm4IuE/9u+/PH2JXZfbwz4zw1WbO+SQPpXfwG/BBgAhCNZiSb/pOQAAAAASUVORK5CYII=);\n}",colors:{red:"#eed3d7"}}}},s=!1,p={autoHide:!1,autoHideDelay:2e3,arrowShow:!0,arrowSize:5,position:null,style:null,color:"red",colors:{red:"#b94a48",green:"#33be40",black:"#393939",blue:"#00f"},showAnimation:"slideDown",showDuration:400,hideAnimation:"slideUp",hideDuration:200,offsetY:2,offsetX:0},u=function(e){return $(t.createElement(e))},h=function(e,t){var i;return i=function(){},i.prototype=e,$.extend(!0,new i,t)},o=u("div").addClass(""+a+"Corner"),l=function(e){var t,i;return e.is("[type=radio]")&&(i=e.parents("form:first").find("[type=radio]").filter(function(t,i){return $(i).attr("name")===e.attr("name")}),e=i.first()),t=e.prev(),t.is("span.styled,span.OBS_checkbox")&&(e=t),e},d=function(e){var t;if(e&&e.css)return t=e.cssElem,t?t.html(e.css):(t=u("style").attr("type","text/css").html(e.css),$("head").append(t),e.cssElem=t)},n=function(){function t(e,t,i){"string"==typeof i&&(i={color:i}),this.options=h(p,$.isPlainObject(i)?i:{}),this.loadCSS(),this.loadHTML(),this.wrapper=$(f.core.html),this.wrapper.data(a,this),this.arrow=this.wrapper.find("."+a+"Arrow"),this.container=this.wrapper.find("."+a+"Container"),this.container.append(this.userContainer),e&&e.length?(this.elementType=e.attr("type"),this.originalElement=e,this.elem=l(e),this.elem.data(a,this),this.elem.before(this.wrapper)):(this.options.arrowShow=!1,o.prepend(this.wrapper)),this.container.hide(),this.run(t)}return t.prototype.loadCSS=function(e){var t;return e||(t=this.options.style,e=this.getStyle(t)),d(e)},t.prototype.loadHTML=function(e){if(e=this.getStyle(name),this.userContainer=$(e.html),this.text=this.userContainer.find("[data-notify=text]"),0===this.text.length)throw"style: "+name+" HTML is missing the: data-notify='text' attribute";return this.text.addClass(""+a+"Text")},t.prototype.show=function(e){var t,n;return n=this.container.parent().parents(":hidden").length>0,t=this.container.add(this.arrow),n&&e&&t.show(),n&&!e&&t.hide(),!n&&e&&t[this.options.showAnimation](this.options.showDuration),n||e?i:t[this.options.hideAnimation](this.options.hideDuration)},t.prototype.updatePosition=function(){var e,t,i,n;if(this.elem){switch(e=this.elem.position(),t=this.wrapper.position(),n=this.getPosition(),i={top:0,left:0},n){case"bottom":i.top+=this.elem.outerHeight();break;case"right":i.left+=this.elem.width();break;default:throw"Unknown position: "+n}return navigator.userAgent.match(/MSIE/)||(i.top+=e.top-t.top),i.left+=e.left-t.left,i.top+=this.options.offsetY,i.left+=this.options.offsetX,this.updateArrow(i,n),this.container.css(i)}},t.prototype.updateArrow=function(e,t){var n,s,a;if(!this.options.arrowShow||"radio"===this.elementType)return this.arrow.hide(),i;s=r[t],a=this.options.arrowSize,this.arrow.css("border-"+t,a+"px solid "+this.getColor()),this.arrow.css(e);for(n in r)n!==s&&n!==t&&this.arrow.css("border-"+n,a+"px solid transparent");switch(t){case"bottom":e.top+=a;break;case"right":e.left+=a}return this.arrow.show()},t.prototype.getPosition=function(){return this.options.position?this.options.position:this.elem.position().left+this.elem.width()+this.wrapper.width()<$(e).width()?"right":"bottom"},t.prototype.getColor=function(){var e;return e=this.getStyle().colors,e&&e[this.options.color]||this.options.colors[this.options.color]||this.options.color},t.prototype.getStyle=function(e){var t;if(e||(e=this.options.style),s&&!e&&(e="bootstrap"),e||(e="default"),t=f.user[e],!t)throw"Missing style: "+e;return t},t.prototype.updateStyle=function(){var e=this;return this.wrapper.find("[data-notify-style]").each(function(t,i){return $(i).attr("style",$(i).attr("data-notify-style").replace(/\{\{\s*color\s*\}\}/gi,e.getColor()).replace(/\{\{\s*position\s*\}\}/gi,e.getPosition()))})},t.prototype.run=function(e,t){var n,r=this;return $.isPlainObject(t)?$.extend(this.options,t):"string"===$.type(t)&&(this.options.color=t),this.container&&!e?(this.show(!1),i):this.container||e?("string"===$.type(e)?this.text.html(e.replace("\n","<br/>")):this.text.empty().append(e),this.updatePosition(),this.show(!0),this.options.autoHide?(clearTimeout(this.autohideTimer),n=setTimeout(function(){return r.show(!1)},this.options.autoHideDelay)):i):i},t}(),$(function(){return $("body").append(o),$("link").each(function(){var e;return e=$(this).attr("href"),e.match(/bootstrap/)?(s=!0,!1):i}),d(f.core),$(t).on("click","."+a+"Wrapper",function(){var e;return e=$(this).data(a),e?e.show(!1):i})}),$[c]=function(e,t,i){return e instanceof HTMLElement||e.jquery?$(e)[c](t,i):(i=t,t=e,new n(null,t,i))},$[c].options=function(e){return $.extend(p,e)},$[c].styles=function(e){return $.extend(!0,f.user,e)},$.fn[c]=function(e,t){return $(this).each(function(){var i;return i=l($(this)).data(a),i?i.run(e,t):new n($(this),e,t)})}})(e,t),function(t){function n(){this.suppressLog||a("log",this,arguments)}function r(){a("warn",this,arguments)}function s(){a("info",this,arguments)}function a(n,r,s){if(e.console!==i&&e.console.isFake!==!0){var a=t.map(s,h);a[0]=[r.prefix,a[0],r.postfix].join("");var o="boolean"===t.type(a[a.length-1])?a.pop():null;o===!0&&e.console.group(a[0]),a[0]&&null===o&&(e.navigator.userAgent.indexOf("MSIE")>=0?e.console.log(a.join(",")):e.console[n].apply(e.console,a)),o===!1&&e.console.groupEnd()}}function o(e){return{log:function(){n.apply(e,arguments)},warn:function(){r.apply(e,arguments)},info:function(){s.apply(e,arguments)}}}e.console===i&&(e.console={isFake:!0});for(var u=["log","warn","info","group","groupCollapsed","groupEnd"],l=u.length-1;l>=0;l--)e.console[u[l]]===i&&(e.console[u[l]]=t.noop);if(t){var h=function(e){return e},d=function(e){return e=t.extend({},d.defaults,e),o(e)};d.defaults={suppressLog:!1,prefix:"",postfix:""},t.extend(d,o(d.defaults)),t.console===i&&(t.console=d),t.consoleNoConflict=d}}(jQuery);var s={loading:{},loaded:{}},a=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};$.fn.scrollView=function(e){var t=$(this).first();return 1===t.length&&(t.is(".styled")&&(t=t.siblings("span")),$("html, body").animate({scrollTop:Math.max(0,t.offset().top-100)},{duration:1e3,complete:e||$.noop})),$(this)},$.fn.equals=function(e){if($(this).length!==e.length)return!1;for(var t=0,i=$(this).length;i>t;++t)if($(this)[t]!==e[t])return!1;return!0},$.Deferred.serialize=function(e){if(!$.isArray(e)||0===e.length)return $.Deferred().resolve().promise();var t=e[0](),i=1,n=e.length;if(!t||!t.pipe)throw"Invalid Deferred Object";for(;n>i;i++)t=t.pipe(e[i]);return t},$.Deferred.parallelize=function(e){function t(e){r++,r===a&&n.resolve(e)}function i(e){o||(o=!0,n.reject(e))}var n=$.Deferred(),r=0,s=0,a=e.length,o=!1;if(!$.isArray(e)||0===a)return n.resolve();for(;a>s;++s){var u=e[s]();if(!u||!u.done||!u.fail)throw"Invalid Deferred Object";u.done(t).fail(i)}return n.promise()};var o=null;(function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;o=function(){},o.extend=function(i){function n(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var s=new this;e=!1;for(var a in i)s[a]="function"==typeof i[a]&&"function"==typeof r[a]&&t.test(i[a])?function(e,t){return function(){var i=this._super;this._super=r[e];var n=t.apply(this,arguments);return this._super=i,n}}(a,i[a]):i[a];return n.prototype=s,n.prototype.constructor=n,n.extend=arguments.callee,n}})();var u=o.extend({init:function(e,t){this.name=t?t:"Set_"+a(),this.array=[],this.addAll(e)},find:function(e){for(var t=0,i=this.array.length;i>t;++t)if($.isFunction(e)?e(this.get(t)):this.equals(this.get(t),e))return this.get(t);return null},get:function(e){return this.array[e]},has:function(e){return!!this.find(e)},add:function(e){return this.has(e)?!1:(this.array.push(e),!0)},addAll:function(e){if(!e)return 0;$.isArray(e)||(e=[e]);for(var t=0,i=0,n=e.length;n>i;++i)this.add(e[i])&&t++;return t},remove:function(e){for(var t=[],i=0,n=this.array.length;n>i;++i)this.equals(this.get(i),e)||t.push(this.get(i));return this.array=t,e},removeAll:function(){this.array=[]},equals:function(e,t){return e&&t&&e.equals!==i&&t.equals!==i?e.equals(t):e===t},each:function(e){for(var t=0,i=this.array.length;i>t;++t)if(e(this.get(t))===!1)return},map:function(e){return $.map(this.array,e)},filter:function(e){return $.grep(this.array,e)},size:function(){return this.array.length},getArray:function(){return this.array}}),l=u.extend({init:function(e,t,i){this.type=e,this._super(t,i)},add:function(e){e instanceof this.type?this._super(e):this.log("add failed - invalid type")}}),h={checkOptions:function(e){if(e)for(var t in e)g[t]===i&&f("Invalid option: '"+t+"'")},appendArg:function(e,t,i){i||(i=0);var n=[].slice.call(e,i);return n[i]=t+n[i],n},memoize:function(e){return function(){var t=Array.prototype.slice.call(arguments),i="",n=t.length;for(currentArg=null;n--;)currentArg=t[n],i+=currentArg===Object(currentArg)?JSON.stringify(currentArg):currentArg,e.memoize||(e.memoize={});return i in e.memoize?e.memoize[i]:e.memoize[i]=e.apply(this,t)}},dateToString:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},parseDate:function(e){var t=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(!t)return null;var n;if($.datepicker!==i)try{var r=$.datepicker.parseDate("dd/mm/yy",e);n=new Date(r)}catch(s){return null}else n=new Date(parseInt(t[3],10),parseInt(t[2],10)-1,parseInt(t[1],10));return n},isRTL:function(e){var i=$(t),n=$("body"),r=e&&e.hasClass("rtl")||e&&"rtl"===(e.attr("dir")||"").toLowerCase()||i.hasClass("rtl")||"rtl"===(i.attr("dir")||"").toLowerCase()||n.hasClass("rtl")||"rtl"===(n.attr("dir")||"").toLowerCase();return Boolean(r)}},d="0.0.1",c=$.consoleNoConflict({prefix:"verify.js: "}),p=c.log,f=c.warn,m=c.info,g={debug:!1,validateAttribute:"data-validate",validationEventTrigger:"blur",prevalidate:!1,scroll:!0,focusFirstField:!0,hideErrorOnChange:!1,skipHiddenFields:!0,skipNotRequired:!1,errorClass:"error",errorContainer:function(e){return e},beforeSubmit:function(e,t){return t},track:$.noop,showPrompt:!0,prompt:function(e,t,i){"function"===$.type($.notify)&&(i||(i={color:"red"}),$.notify(e,t,i))}};r.prototype=g;var v=o.extend({name:"Class",init:function(){},toString:function(){return(this.type?this.type+": ":"")+(this.name?this.name+": ":"")},log:function(){g.debug&&p.apply(this,h.appendArg(arguments,""+this))},warn:function(){f.apply(this,h.appendArg(arguments,""+this))},info:function(){m.apply(this,h.appendArg(arguments,""+this))},bind:function(e){var t=this[e];t&&$.isFunction(t)&&(this[e]=$.proxy(t,this))},bindAll:function(){for(var e in this)this.bind(e)},nextTick:function(t,i,n){var r=this;return e.setTimeout(function(){t.apply(r,i)},n||0)}}),y=v.extend({init:function(e,t){this.name=e,this.buildFn(t)},buildFn:function(e){if(!$.isPlainObject(e))return this.warn("rule definition must be a function or an object");for(this.userObj=$.extend(!0,{},e),this.type=e.type;"string"===$.type(this.userObj.extend);){var t=this.userObj.extend;delete this.userObj.extend;var i=b.getRawRule(t);if(this.userObj===i)return this.warn("Cannot extend self");if(!$.isPlainObject(i))return this.warn("Cannot extend: '"+t+"'");this.userObj=$.extend(!0,{},i,this.userObj)}if($.isFunction(this.userObj.fn))this.fn=this.userObj.fn,delete this.userObj.fn;else{if("regexp"!==$.type(this.userObj.regex))return this.warn("rule definition lacks a function");this.fn=function(e){return function(t){var i=RegExp(e);return t.val().match(i)?!0:t.message||"Invalid Format"}}(this.userObj.regex),delete this.userObj.regex}this.ready=!0},defaultInterface:{log:p,warn:f,ajax:function(e){n(e,this)}},defaultFieldInterface:{val:function(){return this.field.val.apply(this.field,arguments)}},defaultGroupInterface:{val:function(e,t){var n=this.field(e);return n?t===i?n.val():n.val(t):i},field:function(e){var t=$.grep(this._exec.members,function(t){return t.id===e}),i=t.length?t[0].element.domElem:null;return i||this.warn("Cannot find group element with id: '"+e+"'"),i},fields:function(){return $().add($.map(this._exec.members,function(e){return e.element.domElem}))}},buildInterface:function(e){var t=[];return t.push({}),t.push(this.userObj),t.push(this.defaultInterface),"field"===this.type&&(t.push(this.defaultFieldInterface),t.push({field:e.element.domElem})),"group"===this.type&&t.push(this.defaultGroupInterface),t.push({form:e.element.form.domElem,callback:e.callback,args:e.args,_exec:e}),$.extend.apply(this,t)}}),b=null;(function(){var e=function(e){for(var t,n,r=e.split(""),s=[],a=0,o=0,u=r.length;u>o;++o){if(t=r[o],"("===t&&a++,")"===t&&a--,a>1)return null;","===t&&1===a&&(r[o]=";")}return 0!==a?null:($.each(r.join("").split(","),function(t,r){return(n=r.match(/^(\w+)(\.(\w+))?(\#(\w+))?(\((\w+(\;\w+)*)\))?$/))?(r={},r.name=n[1],n[3]&&(r.scope=n[3]),n[5]&&(r.id=n[5]),r.args=n[7]?n[7].split(";"):[],s.push(r),i):f("Invalid validate attribute: "+e)}),s)},t=h.memoize(e),n={},r={},s=function(e,t){for(var i in t)n[i]&&f("validator '%s' already exists",i),$.isFunction(t[i])&&(t[i]={fn:t[i]}),t[i].type=e;$.extend(!0,n,t)},a=function(e){s("field",e)},o=function(e){s("group",e)},u=function(e){return n[e]},l=function(e){var t=r[e],i=n[e];return i?t||(t=new y(e,i),r[e]=t):f("Missing rule: "+e),t},d=function(e){var i=e.form.options.validateAttribute,n=e.domElem.attr(i);return n?t(n):null},c=function(e){var t=!1,i=[];return"ValidationField"!==e.type?f("Cannot get rules from invalid type"):e.domElem?(i=this.parseAttribute(e))?(i=$.map(i,function(e){return"required"===e.name&&(t=!0),e.rule=l(e.name),e}),i.required=t,i):[]:[]};b={addFieldRules:a,addGroupRules:o,getRule:l,getRawRule:u,parseString:e,parseAttribute:d,parseElement:c}})();var x=null;(function(){var e=v.extend({type:"ValidationElement",init:function(e){if(!e||!e.length)throw"Missing Element";return this.domElem=e,this.bindAll(),this.name=this.domElem.attr("name")||this.domElem.attr("id")||a(),this.execution=null,e.data("verify")?!1:(e.data("verify",this),!0)},equals:function(t){var i,n;return this.domElem?(i=this.domElem,t.jquery?n=t:t instanceof e&&t.domElem&&(n=t.domElem),i&&n?i.equals(n):!1):!1}}),n=e.extend({type:"ValidationField",init:function(e,t){this._super(e),this.form=t,this.options=t.options,this.groups=t.groups,this.ruleNames=null},validate:function(e){return new E(this).execute().always(function(t){e&&e(t.success,t.result)}),i},update:function(){this.rules=b.parseElement(this);for(var e=0;this.rules.length>e;++e){var t=this.rules[e];if(t.rule&&"group"===t.rule.type){this.groups[t.name]||(this.groups[t.name]={});var i=t.scope||"default";this.groups[t.name][i]||(this.groups[t.name][i]=new l(n)),this.groups[t.name][i].add(this)}}},handleResult:function(e){if(!e.errorDisplayed&&(e.errorDisplayed=!0,$.isArray(e.result))){var t,i,n,r=this.options,s=[],a=null;for(i=0;e.result.length>i;++i)n=e.result[i].domElem,t=e.result[i].result,r.showPrompt&&r.prompt(n,t),t&&s.push(t),a=r.errorContainer(n),a&&a.length&&a.toggleClass(r.errorClass,!e.success);this.trackResult(this.domElem,s.join(","),e)}},trackResult:function(e,t,i){i.parent&&i.parent.formExecution||this.options.track("Validate",[this.form.name,this.name].join(" "),i.skip?"Skip":i.success?"Valid":t)}});x=e.extend({type:"ValidationForm",init:function(e,s){if(this._super(e),!e.is("form"))throw"Must be a form";this.options=new r(s),this.fields=new l(n),this.groups={},this.fieldByName={},this.invalidFields={},this.fieldHistory={},this.submitResult=i,this.submitPending=!1,this.cache={ruleNames:{},ajax:{loading:{},loaded:{}}},$(t).ready(this.domReady)},extendOptions:function(e){$.extend(!0,this.options,e)},domReady:function(){this.bindEvents(),this.updateFields(),this.log("bound to "+this.fields.size()+" elems");var e=this.options,t=e.showPrompt;e.prevalidate&&(e.showPrompt=!1,this.validate(function(){e.showPrompt=t}))},bindEvents:function(){this.domElem.on("keyup.jqv","input",this.onKeyup).on("blur.jqv","input[type=text]:not(.hasDatepicker),input:not([type].hasDatepicker)",this.onValidate).on("change.jqv","input[type=text].hasDatepicker",this.onValidate).on("change.jqv","select,[type=checkbox],[type=radio]",this.onValidate).on("submit.jqv",this.onSubmit).on("validated.jqv",this.scrollFocus).trigger("initialised.jqv")},unbindEvents:function(){this.domElem.off(".jqv")},updateFields:function(){var e="["+this.options.validateAttribute+"]";this.domElem.find(e).each(this.updateField)},updateField:function(e,t){e.jquery!==i&&(t=e),t.jquery===i&&(t=$(t));var r,s,a="input:not([type=hidden]),select,textarea";return t.is(a)?(s=t,r=this.fields.find(s),r||(r=new n(s,this),this.fields.add(r)),r.update(),r):this.warn("Validators will not work on container elements ("+t.prop("tagName")+"). Please use INPUT, SELECT or TEXTAREA.")},onSubmit:function(e){var t=!1;return this.submitPending&&this.warn("pending..."),this.submitPending||this.submitResult!==i?this.submitResult!==i&&(t=this.options.beforeSubmit.call(this.domElem,e,this.submitResult)):(this.submitPending=!0,this.validate(this.doSubmit)),t||e.preventDefault(),t},doSubmit:function(e){this.submitPending=!1,this.submitResult=e,this.domElem.submit(),this.submitResult=i},onKeyup:function(e){this.options.hideErrorOnChange&&this.options.prompt($(e.currentTarget),!1)},onValidate:function(e){var t=$(e.currentTarget),i=t.data("verify")||this.updateField(t);i.log("validate"),i.validate($.noop)},validate:function(e){return this.updateFields(),new w(this).execute().always(function(t){e&&e(t.success,t.result)}),i},scrollFocus:function(){var e=this.execution;if(e.errors.length){var t=e.errors[0].field,i=this.options.focusFirstField&&t.is("input[type=text]");this.options.scroll?t.scrollView(function(){i&&t.focus()}):i&&t.focus()}}})})();var w=null,E=null;(function(){var e={NOT_STARTED:0,RUNNING:1,COMPLETE:2},t=v.extend({type:"Execution",init:function(t,i){this.element=t,t&&(t.execution=this,this.options=this.element.options,this.domElem=t.domElem),this.parent=i,this.name=a(),this.status=e.NOT_STARTED,this.errorField=null,this.errors=[],this.bindAll()},toString:function(){return this._super()+(""+(this.element||this.rule))},serialize:function(e){if(this.d=$.Deferred.serialize($.map(e,function(e){return $.isFunction(e)?e:e.execute})),!this.d)throw"Invalid executable";return this.d.promise()},parallelize:function(e){if(this.d=$.Deferred.parallelize($.map(e,function(e){return $.isFunction(e)?e:e.execute})),!this.d)throw"Invalid executable";return this.d.promise()},execute:function(){this.status=e.RUNNING,this.domElem&&this.domElem.triggerHandler("validating")},executed:function(t){this.log(t.success?"Passed":"Failed"),this.status=e.COMPLETE,this.skip=t.skip,this.success=t.success,this.result=t.result,this.domElem&&this.domElem.triggerHandler("validated",arguments),this.success&&this.errors.push({domElem:this.element,msg:this.result})},resolve:function(){return this.resolveOrReject(!0)},reject:function(){return this.resolveOrReject(!1)},resolveOrReject:function(e){var t=e?"resolve":"reject";if(!this.d||!this.d[t])throw"Invalid Deferred Object";return this.success=!!e,this.nextTick(this.d[t],[this],0),this.d.promise()},skipValidations:function(){return this.element.form.options.skipHiddenFields&&(!this.domElem.hasClass("styled")&&this.domElem.is(":hidden")||this.domElem.hasClass("styled")&&this.domElem.parents(":hidden").length>0)?!0:this.domElem.is("[disabled]")?!0:!1}});w=t.extend({type:"FormExecution",init:function(e){this._super(e),this.ajaxs=[],this.children=this.element.fields.map($.proxy(function(e){return new E(e,this)},this))},execute:function(){return this._super(),this.log("exec fields #"+this.children.length),this.parallelize(this.children).always(this.executed)},executed:function(e){this._super(e)}}),E=t.extend({type:"FieldExecution",init:function(e,t){this._super(e,t),t instanceof w&&(this.formExecution=t),this.children=[]},execute:function(){this._super();var e=b.parseElement(this.element);return this.d=null,this.skipValidations()?this.log("skip"):!this.options.skipNotRequired||e.required||$.trim(this.domElem.val())?0===e.length?this.log("no validators"):(this.children=$.map(e,$.proxy(function(e){return"group"===e.rule.type?new r(e,this):new n(e,this)},this)),this.serialize(this.children)):this.log("not required"),this.skip=null===this.d,null===this.d&&(this.d=$.Deferred(),this.resolve()),this.d.always(this.executed),this.d.promise()},executed:function(e){this._super(e),this.element.handleResult(e)}});var n=t.extend({type:"RuleExecution",init:function(e,t){this._super(null,t),this.d=$.Deferred(),this.d.always(this.executed),this.rule=e.rule,this.args=e.args,this.element=this.parent.element,this.options=this.element.options,this.rObj={}},callback:function(e){if(clearTimeout(this.t),this.callbackCount++,!(this.callbackCount>1)){e===i&&this.warn("Undefined result");var t=e===!0;t?this.resolve():(this.result=e,this.reject())}},timeout:function(){this.warn("timeout!"),this.callback("Timeout")},execute:function(){if(this._super(),this.callbackCount=0,!this.element||!this.rule.ready)return this.warn(this.element?"not  ready.":"invalid parent."),this.resolve();this.t=setTimeout(this.timeout,1e4),this.r=this.rule.buildInterface(this);var e;try{e=this.rule.fn(this.r)}catch(t){this.skip=!0,e=!0,console.error("Error caught in validation rule: '"+this.rule.name+"', skipping.\nERROR: "+(""+t)+"\nSTACK:"+t.stack)}return e!==i&&this.nextTick(this.callback,[e]),this.d.promise()},executed:function(){this.transformResult(),this._super(this)},transformResult:function(){"string"==typeof this.result?this.result=[{domElem:this.element.domElem,result:this.result}]:$.isArray(this.result)||(this.result=[{domElem:this.element.domElem,result:null}])}}),r=n.extend({type:"GroupRuleExecution",init:function(e,t){this._super(e,t),this.group=e.name,this.id=e.id,this.scope=e.scope||"default"},execute:function(){var e=this.element.groups[this.group][this.scope];if(!e)throw"Missing Group Set";return 1===e.size()&&this.warn("Group only has 1 field. Consider a field rule."),this.getMembers(e),this.realExecute=$.proxy(this._super,this),this.parent.formExecution?this.executeAll():this.executeOne()},isMember:function(e){return e instanceof r&&this.group===e.group&&this.scope===e.scope},getMembers:function(t){var n=!0,r=[],s=this;t.each(function(t){var a=t.execution;a&&a.children.length||(n=!1);var o=null;return n&&$.each(a.children,function(t,a){return!s.isMember(a)||(r.push(a),!o||o.status===e.COMPLETE&&o.success)?(o=a,i):(n=!1,!1)}),n}),this.members=n?r:null},executeOne:function(){return this.members?this.realExecute():(this.skip=!0,this.reject())},executeAll:function(){return this.members?($.each(this.members,this.linkExec),this.realExecute()):this.d.promise()},linkExec:function(e,t){this!==t&&(this.d.done(t.d.resolve),this.d.fail(t.d.reject),t.parent.d.fail(this.d.reject))},transformResult:function(){if(!this.members)return this._super();var e,t,i,n=[],r=$.isPlainObject(this.result),s="string"==typeof this.result;for(t=0;this.members.length>t;++t)e=this.members[t],s?i=this===e?this.result:null:r&&(i=this.result[e.id]),n.push({domElem:e.element.domElem,result:i});this.result=n}})})(),$.fn.validate=function(e){var t=$(this).data("verify");t?t.validate(e):f("element does not have async validator attached")},$.fn.validate.version=d,$.fn.verify=function(e){return this.each(function(){var t=$.verify.forms.find($(this));return e===!1||"destroy"===e?(t&&(t.unbindEvents(),$.verify.forms.remove(t)),i):(h.checkOptions(e),t?t.extendOptions(e):(t=new x($(this),e),$.verify.forms.add(t)),i)})},$.verify=function(e){h.checkOptions(e),$.extend(g,e)},$.extend($.verify,{version:d,updateRules:b.updateRules,addRules:b.addFieldRules,addFieldRules:b.addFieldRules,addGroupRules:b.addGroupRules,log:m,warn:f,defaults:g,globals:g,utils:h,forms:new l(x,[],"FormSet"),_hidden:{ruleManager:b}}),$(function(){$("form").filter(function(){return $(this).find("["+g.validateAttribute+"]").length>0}).verify()}),p("plugin added."),function(t){return t.verify===i?(e.alert("Please include verify.js before each rule file"),i):(t.verify.addFieldRules({currency:{regex:/^\$?\-?\d+(,\d+)*(\.\d+)?$/,message:"Invalid monetary value"},email:{regex:/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Invalid email address"},alphanumeric:{regex:/^[0-9A-Za-z]+$/,message:"Use digits and letters only"},street_number:{regex:/^\d+[A-Za-z]?(-\d+)?[A-Za-z]?$/,message:"Street Number only"},number:{regex:/^\d+$/,message:"Use digits only"},numberSpace:{regex:/^[\d\ ]+$/,message:"Use digits and spaces only"},postcode:{regex:/^\d{4}$/,message:"Invalid postcode"},date:{fn:function(e){return t.verify.utils.parseDate(e.val())?!0:e.message},message:"Invalid date"},required:{fn:function(e){return e.requiredField(e,e.field)},requiredField:function(e,i){var n=i.val();switch(i.prop("type")){case"radio":case"checkbox":var r=i.attr("name");if(0===e.form.find("input[name='"+r+"']:checked").size())return 1===e.form.find("input[name='"+r+"']").size()?e.messages.checkboxSingle:e.messages.checkboxMultiple;break;default:if(!t.trim(n))return e.messages.all}return!0},messages:{all:"This field is required",checkboxMultiple:"Please select an option",checkboxSingle:"This checkbox is required"}},regex:{fn:function(e){var t;try{var i=e.args[0];t=RegExp(i)}catch(n){return e.warn("Invalid regex: "+i),!0}return e.val().match(t)?!0:e.message||"Invalid Format"},message:"Invalid format"},asyncTest:function(e){e.prompt("Please wait..."),setTimeout(function(){e.callback()},2e3)},phone:function(e){e.val(e.val().replace(/\D/g,""));var t=e.val();return t.match(/^[\d\s]+$/)?t.match(/^0/)?10!==t.replace(/\s/g,"").length?"Must be 10 digits long":!0:"Number must start with 0":"Use digits and spaces only"},size:function(e){var t=e.val(),n=e.args[0],r=e.args[1];if(n!==i&&r===i){var s=parseInt(n,10);if(e.val().length!==s)return"Must be "+s+" characters"}else if(n!==i&&r!==i){var a=parseInt(n,10);if(r=parseInt(r,10),a>t.length||t.length>r)return"Must be between "+a+" and "+r+" characters"}else console.log("size validator parameter error on field: "+e.field.attr("name"));return!0},min:function(e){var t=e.val(),i=parseInt(e.args[0],10);return i>t.length?"Must be at least "+i+" characters":!0},max:function(e){var t=e.val(),i=parseInt(e.args[0],10);return t.length>i?"Must be at most "+i+" characters":!0},decimal:function(e){var t=e.val(),i=e.args[0]?parseInt(e.args[0],10):2;if(!t.match(/^\d+(,\d{3})*(\.\d+)?$/))return"Invalid decimal value";var n=parseFloat(t.replace(/[^\d\.]/g,"")),r=Math.pow(10,i);return n=Math.round(n*r)/r,e.field.val(n),!0},min_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),i=e.args[1]||"",n=parseFloat(e.args[0]);return n>t?"Must be greater than "+n+i:!0},max_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),i=e.args[1]||"",n=parseFloat(e.args[0]);return t>n?"Must be less than "+n+i:!0},range_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),i=e.args[2]||"",n=e.args[3]||"",r=parseFloat(e.args[0]),s=parseFloat(e.args[1]);return t>s||r>t?"Must be between "+i+r+n+"\nand "+i+s+n:!0},agreement:function(e){return e.field.is(":checked")?!0:"You must agree to continue"},minAge:function(e){var i=e.args[0];if(!i||isNaN(parseInt(i,10)))return console.log("WARNING: Invalid Age Param: "+i),!0;new Date;var n=new Date;n.setFullYear(n.getFullYear()-parseInt(i,10));var r=t.verify.utils.parseDate(e.val());return"Invalid Date"===r?"Invalid Date":r>n?"You must be at least "+i:!0}}),t.verify.addGroupRules({dateRange:function(e){var i=e.field("start"),n=e.field("end");if(0===i.length||0===n.length)return e.warn("Missing dateRange fields, skipping..."),!0;var r=t.verify.utils.parseDate(i.val());if(!r)return"Invalid Start Date";var s=t.verify.utils.parseDate(n.val());return s?r>=s?"Start Date must come before End Date":!0:"Invalid End Date"}}),i)}(jQuery)})(window,document);